# 技术中台体系

## 体系架构图

![middleplatform](img\middleplatform.png)

## 接入层

### API网关

路由：动态路由

数据安全： 验签与加解密

 

文档参考：http://confluence.allinpaycard.cn/pages/viewpage.action?pageId=39748285



### SDK

对外提供API服务时，应该提供 SDK加速对接流程

SDK主要工作：

- 定义输入输出
- 实现参数的签名和加密 



### 聚合服务

1.  管理平台聚合服务

   (1) 对接BM后台管理系统

   (2) 命名规范 项目-web-admin,  例如： xtys-web-admin

2. API聚合服务

   (1) 对接App，提供API接口

   (2) 命名规范 项目-web-admin， 例如： xtys-api-aggregation

3. 接口安全

   (1) 接口安全通过mcps-oauth-starter提供的接口安全访问

   ​	通过权限注解定制访问权限

   ​	配置白名单

   (2) 文档参考：http://confluence.allinpaycard.cn/pages/viewpage.action?pageId=31392227



## 业务层

​	业务层实现具体业务

### 业务中台

各个业务线通用的业务可以抽取为业务中台， 提供统一服务， 目前的业务中台包括：

1. 字典服务

2. 账号服务

3. 渠道信息服务

4. 产品工厂服务

5. 客户服务

6. 机构服务

7. 产品订购服务

8. 权限管理服务



## 基础框架层



### Mcps微服务框架

微服务实现框架： 参考

http://confluence.allinpaycard.cn/pages/viewpage.action?pageId=31392187

 

### 接口安全框架

1. OAuth2保护接口安全
2. 支持不同的登录模式
3. 参考

http://confluence.allinpaycard.cn/pages/viewpage.action?pageId=33691217

 

 

### Mcps Starter

启动器提供了即插即用的功能， 通过引用不同的启动器来快速的引入所需功能

http://confluence.allinpaycard.cn/pages/viewpage.action?pageId=31392174

 

启动器列表

1. mcps-root-starter: 根启动器

2. mcps-starter-starter: starter启动器

3. mcps-service-starter: 微服务启动器

4. mcps-client-starter: 非服务类启动器

5. mcps-cache-starter: 缓存启动器

   http://confluence.allinpaycard.cn/pages/viewpage.action?pageId=39748114

6. mcps-jpa-starter: JPA项目启动器

   

7. mcps-oauth2-starter: 需认证项目启动器

8. mcps-queue-kafka-starter： kafka队列启动器

9. mcps-queue-rocketmq-starter: rocket队列启动器

   http://confluence.allinpaycard.cn/pages/viewpage.action?pageId=39748112

10. mcps-baffle-starter： 挡板启动器

11. mcps-doc-starter： 文档启动器

12. mcps-logger-starter： 日志启动器

    http://confluence.allinpaycard.cn/pages/viewpage.action?pageId=39748120

13. mcps-schedule-ej-starter: 定时任务启动器

    http://confluence.allinpaycard.cn/pages/viewpage.action?pageId=31394331



## 技术框架

### Spring技术栈

1. JDK8

2. Spring Boot

3. Spring Cloud

 

### 技术选型

注册中心： nacos

配置中心： nacos

地址： http://172.19.5.32:18848/nacos/

网关： spring-cloud-gateway

AMP： Skywalking

监控： Prometheus

日志： ELK

流控：sentinel

 http://confluence.allinpaycard.cn/pages/viewpage.action?pageId=41877961



## 平台服务

### Swagger API文档

地址： http://swagger2-api.allinpaycard.cn/swagger-ui/

用户命名: user@user

### 监控

#### 服务墙 （Spring Boot Admin）

地址： http://172.19.5.33:50740/wallboard

服务的实例，版本信息，日志配置， URL， 缓存， JVM等等

#### JVM监控 （Grafana+Prometheus）

地址： http://172.19.5.33:13000/d/spring_boot_21/spring-boot-2-1-statistics?orgId=1



